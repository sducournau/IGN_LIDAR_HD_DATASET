# LOD2 Preprocessing - Simplified Experiment Config
#
# This config uses the new modular approach for LOD2 building detection.
# Much simpler than the old config_lod2_preprocessing.yaml!
#
# Usage:
#   ign-lidar-hd process experiment=lod2_preprocessing_v2 \
#     input_dir=/path/to/tiles \
#     output_dir=/path/to/output

# @package _global_

defaults:
  - /processor: gpu
  - /features: lod2
  - /preprocess: default
  - /stitching: enabled
  - /output_mode: enriched_only
  - /data_sources: bd_topo_minimal # Only essential features for LOD2
  - _self_

# Override only what's unique to LOD2 preprocessing
processor:
  lod_level: LOD2
  skip_existing: true
  building_detection_mode: lod2
  transport_detection_mode: lod2

  # Reclassification settings (stricter for LOD2)
  reclassification:
    enabled: true
    acceleration_mode: auto
    use_geometric_rules: true
    ndvi_vegetation_threshold: 0.3
    ndvi_road_threshold: 0.15
    road_vegetation_height_threshold: 2.0
    building_buffer_distance: 1.5 # Smaller buffer for precise edges
    max_building_height_difference: 2.5 # Stricter tolerance

# Required paths
input_dir: ???
output_dir: ???
cache_dir: ${oc.env:IGN_CACHE_DIR,/tmp/ign_cache}
