# @package _global_

# Multi-Scale Dataset Configuration
# Purpose: Create unified dataset with multiple patch sizes (50m, 100m, 150m)
# Use Case: Multi-scale learning, hybrid model training

defaults:
  - override /processor: default
  - override /features: full
  - override /preprocess: default
  - override /stitching: enhanced
  - override /output: patches_only

# Dataset creation settings for multi-scale
dataset:
  enabled: true
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  random_seed: 42
  split_by_tile: true # Important: same tile goes to same split across all scales
  create_split_dirs: true
  patch_sizes: [50, 100, 150] # All scales
  balance_across_sizes: true # Balance samples across scales

# Processor configuration (will be overridden per scale)
processor:
  lod_level: LOD3
  architecture: hybrid
  use_gpu: true
  num_workers: 4
  augment: true
  pin_memory: true
  processing_mode: patches_only
  skip_existing: true

# Feature configuration
features:
  mode: full
  include_extra: true
  use_rgb: true
  use_infrared: true
  compute_ndvi: true
  sampling_method: fps
  normalize_xyz: true
  normalize_features: true
  gpu_batch_size: 1000000
  use_gpu_chunked: true

# Preprocessing
preprocess:
  enabled: true
  sor_std: 2.0
  voxel_enabled: false

# Stitching
stitching:
  enabled: true
  auto_detect_neighbors: true
  auto_download_neighbors: true
  cache_enabled: true

# Output configuration
output:
  format: npz,laz
  processing_mode: patches_only
  save_stats: true
  save_metadata: true
  compression: null

# Logging
log_level: INFO
verbose: true
# Usage:
# This config is a template. Use the individual scale configs and merge:
#
# # Generate all scales
# ign-lidar-hd process experiment=dataset_50m input_dir=... output_dir=data/multiscale
# ign-lidar-hd process experiment=dataset_100m input_dir=... output_dir=data/multiscale
# ign-lidar-hd process experiment=dataset_150m input_dir=... output_dir=data/multiscale
#
# The same random_seed ensures tiles go to same splits across all scales
#
# Expected output structure:
# data/multiscale/
#   train/
#     LHD_FXX_0649_6863_hybrid_patch_0001_scale50m.npz
#     LHD_FXX_0649_6863_hybrid_patch_0001_scale100m.npz
#     LHD_FXX_0649_6863_hybrid_patch_0001_scale150m.npz
#     ...
#   val/
#     ...
#   test/
#     ...
#   dataset_metadata.json
#   multiscale_dataset_metadata.json
