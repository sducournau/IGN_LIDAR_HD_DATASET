# Full Pipeline Configuration
# This configuration runs the complete workflow: download â†’ enrich â†’ patch

# Global settings (apply to all stages)
global:
  num_workers: 4
  output_dir: data/processed

# Stage 1: Download LiDAR tiles from IGN
download:
  # Bounding box in WGS84 (lon_min, lat_min, lon_max, lat_max)
  # Example: Paris area
  bbox: "2.3, 48.8, 2.4, 48.9"

  # Output directory for downloaded tiles
  output: "data/raw"

  # Maximum number of tiles to download (optional)
  max_tiles: 10

  # Number of parallel downloads (default: 3)
  # num_workers: 3  # Uses global if not specified

# Stage 2: Enrich tiles with geometric features and RGB
enrich:
  # Input directory (from download stage)
  input_dir: "data/raw"

  # Output directory for enriched tiles
  output: "data/enriched"

  # Feature mode: 'core' (basic) or 'full' (all features)
  mode: "full"

  # Number of neighbors for feature computation
  k_neighbors: 10

  # ðŸ†• v1.7.1: Automatic parameter analysis for optimal processing
  # Analyzes each tile to determine best radius, SOR, and ROR parameters
  auto_params: false

  # Search radius for geometric features (in meters)
  # radius: 1.0

  # Use GPU acceleration if available
  use_gpu: true

  # Add RGB colors from IGN orthophotos
  add_rgb: true

  # Directory to cache downloaded orthophotos
  rgb_cache_dir: "cache/orthophotos"

  # ðŸ†• v1.7.0: Point cloud preprocessing for artifact mitigation
  # Enable preprocessing to reduce scan line artifacts and noise
  preprocess: false

  # Statistical Outlier Removal (SOR) parameters
  # Note: If auto_params is true, these will be overridden with analyzed values
  sor_k: 12 # Number of nearest neighbors
  sor_std_multiplier: 2.0 # Standard deviation multiplier

  # Radius Outlier Removal (ROR) parameters
  # Note: If auto_params is true, these will be overridden with analyzed values
  ror_radius: 1.0 # Search radius in meters
  ror_min_neighbors: 4 # Minimum neighbors required

  # Voxel downsampling (optional) - uncomment to enable
  # voxel_size: 0.5            # Voxel size in meters

  # Auto-convert to QGIS format
  # auto_convert_qgis: false

  # Force re-enrichment even if files exist
  # force: false

# Stage 3: Create training patches
patch:
  # Input directory (from enrich stage)
  input_dir: "data/enriched"

  # Output directory for patches
  output: "data/patches"

  # LOD level: 'LOD2' or 'LOD3'
  lod_level: "LOD2"

  # Patch size in meters
  patch_size: 150.0

  # Patch overlap ratio (0.0 to 1.0)
  patch_overlap: 0.1

  # Target number of points per patch
  num_points: 16384 # Options: 4096, 8192, 16384


  # Include architectural style features
  # include_architectural_style: false

  # Style encoding: 'constant' or 'multihot'
  # style_encoding: "constant"

  # Number of neighbors for feature computation (auto if not specified)
  # k_neighbors: 20

  # Bounding box filter (optional): xmin,ymin,xmax,ymax in LAMB93
  # bbox: "650000, 6860000, 660000, 6870000"
