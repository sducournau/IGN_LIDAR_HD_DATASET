# Enrich-Only Pipeline Configuration
# This configuration only enriches existing LAZ files with geometric features and RGB

# Global settings
global:
  num_workers: 4

# Stage: Enrich tiles with geometric features and RGB
enrich:
  # Input directory with raw LAZ files
  input_dir: "data/raw"

  # Output directory for enriched tiles
  output: "data/enriched"

  # Feature mode: 'core' (basic) or 'building' (full features)
  mode: "building"

  # Number of neighbors for feature computation
  k_neighbors: 10

  # ðŸ†• v1.7.1: Automatic parameter analysis for optimal processing
  # Analyzes each tile to determine best radius, SOR, and ROR parameters
  auto_params: false

  # Search radius for geometric features (in meters)
  # Use radius-based search to eliminate LIDAR scan line artifacts
  # Set to null/omit to auto-estimate, or specify manually (0.5-3.0m typical)
  # radius: 1.0

  # Use GPU acceleration if available
  use_gpu: true

  # Add RGB colors from IGN orthophotos
  add_rgb: true

  # Directory to cache downloaded orthophotos (recommended)
  rgb_cache_dir: "cache/orthophotos"

  # ðŸ†• v1.7.0: Point cloud preprocessing for artifact mitigation
  # Enable preprocessing to reduce scan line artifacts and noise
  preprocess: false

  # Statistical Outlier Removal (SOR) parameters
  # Note: If auto_params is true, these will be overridden with analyzed values
  sor_k: 12 # Number of nearest neighbors
  sor_std_multiplier: 2.0 # Standard deviation multiplier

  # Radius Outlier Removal (ROR) parameters
  # Note: If auto_params is true, these will be overridden with analyzed values
  ror_radius: 1.0 # Search radius in meters
  ror_min_neighbors: 4 # Minimum neighbors required

  # Voxel downsampling (optional)
  # voxel_size: 0.5            # Voxel size in meters (uncomment to enable)

  # Preprocessing presets (uncomment one to use):
  # Auto-analyzed (recommended):
  #   auto_params: true  # Automatically determines best parameters for each tile
  # Conservative (preserve details):
  #   sor_k: 15, sor_std_multiplier: 3.0, ror_radius: 1.5, ror_min_neighbors: 3
  # Standard (balanced):
  #   sor_k: 12, sor_std_multiplier: 2.0, ror_radius: 1.0, ror_min_neighbors: 4
  # Aggressive (maximum artifact removal):
  #   sor_k: 10, sor_std_multiplier: 1.5, ror_radius: 0.8, ror_min_neighbors: 5
  # Memory-optimized (large datasets):
  #   voxel_size: 0.4, sor_k: 10, sor_std_multiplier: 2.0

  # Number of parallel workers (overrides global)
  num_workers: 4

  # Auto-convert to QGIS-compatible format
  auto_convert_qgis: false

  # Force re-enrichment even if files exist
  force: false
